define(["domReady!","echarts","jquery","underscore","bootstrap","accounting"],function(e,n,t,a,o,s){function r(e,t,o){var r=n.init(t),l=[];if(a.map(e,function(e){e.Amount>0&&l.push({name:e.Title,value:parseFloat(s.toFixed(e.Amount,2)),color:o[e.Key]})}),0==l.length&&l.push({name:"暂无数据",value:.01,color:"#eee"}),(window.ActiveXObject||"ActiveXObject"in window)&&1==l.length){var i=l.pop();l.push(i,i)}var d={color:a.map(l,function(e){return e.color}),tooltip:{show:!0,trigger:"item",backgroundColor:"#fff",hideDelay:0,padding:[5,10,5,10],textStyle:{color:"#073473"},formatter:function(e){return"暂无数据"==e.name?"暂无数据":e.name+"：<span>"+s.formatMoney(e.value,"")+"</span>元"}},calculable:!1,series:[{name:"资产明细",type:"pie",radius:["68%","90%"],minAngle:3,itemStyle:{normal:{label:{show:!1},labelLine:{show:!1}}},data:l}]};r.setOption(d)}t(".sign-btn").click(function(){t(this).hasClass("signed")||(function(){t(".sign-btn").html("今日已签到").removeClass("common-btn-blue").addClass("common-btn-gray signed")}(),t.ajax({type:"POST",url:"/UserScore/Sign",cache:!1,dataType:"json"}).then(function(e){e.canUseScore&&t(".available-score").text(parseFloat(e.canUseScore).toFixed(2)),e.signedDays&&t(".sign-in-container .days span").text(e.signedDays)},function(){}))}),t(".detail-tab .ever").click(function(){var e=t(this).attr("data-type");t(this).addClass("ever-round-border").siblings().removeClass("ever-round-border ever-right-shadow ever-left-shadow"),t(".detail-content ."+e).fadeIn(800).siblings().fadeOut(0),"venus"==e&&t(this).addClass("ever-right-shadow"),"p2p"==e&&t(this).addClass("ever-left-shadow")}),t.ajax({url:"/User/AssetOverview/Asset",method:"GET",cache:!1,dataType:"json"}).done(function(e){t("#revenues-total").html(s.formatMoney(e.totalRevenue,"")),t("#total-p2p").html(s.formatMoney(e.totalRevenue-e.venuseRevenue,"")),t("#total-venus").html(s.formatMoney(e.venuseRevenue,"")),t("#revenues-yesterday").html(s.formatMoney(e.yesterdayRevenue,""));var n=document.getElementById("leave-draw-box");if(n){var a={d_1:"#6bbcff",d_2:"#3793df"};r([{Amount:parseFloat(t(".leave-legend .p2p").attr("data-total")),Key:"d_1",Title:"自选投"},{Amount:parseFloat(t(".leave-legend .venus").attr("data-total")),Key:"d_2",Title:"轻松投"}],n,a);var o=!0,l=!0,i=e.p2pUserInfo;null!=i&&-1!=i.queryStatus&&(i.isChannelUser&&t(".channel-user-wrap").show(),i.isOpenCmbc||(o=!1));var d=e.fundsUserInfo;null!=d&&-1!=d.isOpenFund&&0===d.queryStatus&&0===d.isOpenFund&&(l=!1),!o&&l?t(".open-all").show():(o||t(".open-cmbc").show(),l&&t(".opened-fund").show())}}).fail(function(e,n){}),t(".opened-fund").click(function(){var e=window.JMAnalytics;null!=e&&e.trackEvent("fund-account-link","fund-account-link")})});